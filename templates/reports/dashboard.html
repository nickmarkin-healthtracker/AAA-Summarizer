{% extends 'base.html' %}

{% block title %}Reports - Academic Achievement Summarizer{% endblock %}

{% block page_title %}Reports{% endblock %}

{% block content %}
<div class="summary-stats">
    <div class="stat">
        <div class="stat-value">{{ faculty_count }}</div>
        <div class="stat-label">Faculty with Data</div>
    </div>
    <div class="stat">
        <div class="stat-value">AY {{ current_year.year_code }}</div>
        <div class="stat-label">Current Year</div>
    </div>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
    <div class="card">
        <h3>Points Summary (CSV)</h3>
        <p>Export all faculty points including survey, departmental, and CCC points.</p>
        <a href="{% url 'db_export_points' %}" class="btn btn-app">Download CSV</a>
    </div>

    <div class="card">
        <h3>Faculty Summaries</h3>
        <p>Generate individual or combined faculty reports in PDF or Markdown.</p>
        <a href="{% url 'db_select_faculty' %}" class="btn btn-app">Select Faculty</a>
    </div>

    <div class="card">
        <h3>Activity Type Reports</h3>
        <p>Generate reports grouped by activity type (e.g., all invited lectures, all committee memberships).</p>
        <a href="{% url 'db_select_activities' %}" class="btn btn-app">Select Activities</a>
    </div>

    <div class="card">
        <h3>Verify Impact Factors</h3>
        <p>Compare self-reported IFs against OpenAlex data. Flags publications with difference &ge; 2.</p>
        <a href="{% url 'verify_impact_factors' %}" class="btn btn-app btn-secondary">Verify IFs</a>
    </div>
</div>

<h2>Export Points Summary</h2>
<div class="card">
    <form method="get" action="{% url 'db_export_points' %}">
        <div class="form-group" style="display: inline-block; margin-right: 20px;">
            <label>Academic Year:</label>
            <select name="year">
                {% for year in years %}
                <option value="{{ year.year_code }}" {% if year.is_current %}selected{% endif %}>
                    AY {{ year.year_code }}{% if year.is_current %} (Current){% endif %}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group" style="display: inline-block;">
            <label>Faculty Selection:</label>
            <select name="filter">
                <option value="all">All Faculty</option>
                <option value="avc_eligible">AVC Eligible Only</option>
            </select>
        </div>
        <div style="margin-top: 15px;">
            <button type="submit" class="btn btn-secondary">Download Points CSV</button>
        </div>
    </form>
</div>
{% endblock %}
