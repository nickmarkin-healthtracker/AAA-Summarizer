{% extends 'base.html' %}

{% block title %}Faculty Summary - Academic Achievement Summarizer{% endblock %}

{% block page_title %}Faculty Summary{% endblock %}

{% block extra_css %}
<style>
    .summary-stats {
        display: flex;
        gap: 20px;
        margin-bottom: 25px;
    }
    .stat-card {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 5px;
        padding: 15px 25px;
        text-align: center;
    }
    .stat-value {
        font-size: 28px;
        font-weight: bold;
        color: #2c3e50;
    }
    .stat-label {
        font-size: 12px;
        color: #666;
        text-transform: uppercase;
    }
    .summary-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 13px;
    }
    .summary-table th {
        background: #34495e;
        color: white;
        padding: 10px 8px;
        text-align: center;
        font-weight: 500;
        position: sticky;
        top: 0;
    }
    .summary-table th:first-child {
        text-align: left;
    }
    .summary-table td {
        padding: 8px;
        border-bottom: 1px solid #eee;
        text-align: center;
    }
    .summary-table td:first-child {
        text-align: left;
    }
    .summary-table tr:hover {
        background: #f8f9fa;
    }
    .summary-table tr.no-data {
        color: #999;
    }
    .summary-table tr.no-data td {
        font-style: italic;
    }
    .points-cell {
        font-weight: 500;
    }
    .points-cell.zero {
        color: #ccc;
    }
    .points-cell.has-value {
        color: #27ae60;
    }
    .total-cell {
        font-weight: 700;
        font-size: 14px;
        color: #2c3e50;
    }
    .dept-indicator {
        display: inline-block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #f39c12;
    }
    .dept-indicator.inactive {
        background: #ddd;
    }
    .avc-badge {
        background: #28a745;
        color: white;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 10px;
    }
    .avc-badge.not-eligible {
        background: #dc3545;
    }
    .faculty-link {
        color: #3498db;
        text-decoration: none;
        font-weight: 500;
    }
    .faculty-link:hover {
        text-decoration: underline;
    }
    .table-container {
        overflow-x: auto;
        border: 1px solid #dee2e6;
        border-radius: 5px;
    }
    .legend {
        margin-top: 15px;
        font-size: 12px;
        color: #666;
    }
    .legend-item {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        margin-right: 20px;
    }
</style>
{% endblock %}

{% block content %}
<div class="summary-stats">
    <div class="stat-card">
        <div class="stat-value">{{ total_faculty }}</div>
        <div class="stat-label">Total Faculty</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ faculty_with_data }}</div>
        <div class="stat-label">With Survey Data</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">AY {{ academic_year.year_code }}</div>
        <div class="stat-label">Academic Year</div>
    </div>
</div>

<div class="table-container">
    <table class="summary-table">
        <thead>
            <tr>
                <th style="min-width: 180px;">Faculty</th>
                <th style="width: 60px;">AVC</th>
                <th style="width: 80px;">Citizenship</th>
                <th style="width: 80px;">Education</th>
                <th style="width: 80px;">Research</th>
                <th style="width: 80px;">Leadership</th>
                <th style="width: 80px;">Content Expert</th>
                <th style="width: 80px;">Dept</th>
                <th style="width: 90px;">Total</th>
                <th style="width: 50px;">Dept?</th>
            </tr>
        </thead>
        <tbody>
            {% for item in summary_data %}
            <tr class="{% if not item.has_survey_data %}no-data{% endif %}">
                <td>
                    <a href="{% url 'faculty_detail' item.faculty.email %}" class="faculty-link">
                        {{ item.faculty.display_name }}
                    </a>
                </td>
                <td>
                    {% if item.faculty.is_avc_eligible %}
                    <span class="avc-badge">Yes</span>
                    {% else %}
                    <span class="avc-badge not-eligible">No</span>
                    {% endif %}
                </td>
                <td class="points-cell {% if item.citizenship %}has-value{% else %}zero{% endif %}">
                    {{ item.citizenship|default:"-" }}
                </td>
                <td class="points-cell {% if item.education %}has-value{% else %}zero{% endif %}">
                    {{ item.education|default:"-" }}
                </td>
                <td class="points-cell {% if item.research %}has-value{% else %}zero{% endif %}">
                    {{ item.research|default:"-" }}
                </td>
                <td class="points-cell {% if item.leadership %}has-value{% else %}zero{% endif %}">
                    {{ item.leadership|default:"-" }}
                </td>
                <td class="points-cell {% if item.content_expert %}has-value{% else %}zero{% endif %}">
                    {{ item.content_expert|default:"-" }}
                </td>
                <td class="points-cell {% if item.dept_total %}has-value{% else %}zero{% endif %}">
                    {{ item.dept_total|default:"-" }}
                </td>
                <td class="total-cell">
                    {{ item.grand_total }}
                </td>
                <td>
                    <span class="dept-indicator {% if not item.has_dept_activities %}inactive{% endif %}"
                          title="{% if item.has_dept_activities %}Has departmental activities{% else %}No departmental activities{% endif %}"></span>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="10" style="text-align: center; color: #666; padding: 40px;">
                    No faculty found. <a href="{% url 'roster' %}">Add faculty</a> first.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="legend">
    <span class="legend-item"><span class="dept-indicator"></span> Has departmental activities</span>
    <span class="legend-item"><span class="dept-indicator inactive"></span> No departmental activities</span>
    <span class="legend-item"><span class="avc-badge">Yes</span> AVC Eligible</span>
    <span class="legend-item"><span class="avc-badge not-eligible">No</span> Not AVC Eligible</span>
</div>
{% endblock %}
